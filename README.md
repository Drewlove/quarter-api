# The Quarter

## Summary

The Quarter is a full stack web app. This is the API repo. A second client-side repo also exists.

The purpose of The Quarter is to empower users to easily model a quarterly profit and loss statement for a food business.

To view the app: https://quarter-client.vercel.app/

## Overview

The Quarter API repo includes:

- Migrations and Tables: Description of PostgreSQL tables used in the database
- Authorization: Rules for authorization and authentication
- Service and router logic (including tests)

### Migrations and tables

Tables are created for a PostgreSQL database. Currently, the API repo creates 4 tables:

1. department
2. role
3. shift
4. line_item

All tables have a column for app_user_id which is the sub property of the user object as generated by Auth0. See below for more information about Auth0.

### Authorization and Authentication

Auth0 is a third party authentication and authorization platform (https://auth0.com/). Developer specified authentication logic can be found in the /src/authz/check-jwt.js file. For more information see: https://auth0.com/docs/architecture-scenarios/server-api/api-implementation-nodejs

### Service and Router Logic

Each table has its own corresponding folder to handle API request logic. Each folder has three separate files:

- router: Declares how to handle API requests for a given endpoint.

- routerFunctions: Contains the actual logic for the functions used in the router file.

- service: Using knex, specifies psql commands to manipulate the database and satisfy user requests, such as retrieving rows of information, posting a new row to a table, patching a row, or deleting a row.

### Technologies

Built using Node.js, Express and Knex.

Database is created with PostgreSQL and hosted on Heroku.

Testing done with Mocha and Chai.

### Connecting to Heroku Database

1. To connect to the heroku database, type the following into the console:`psql <connection url>`

- In the place of the `<connection url>` type the actual connection url. To get the url, type `heroku pg:credentials:url` and look for the string after the `connection url:` it should read something like `postgres://very_long_string_numbers_etc.`

3. You can connect to the heroku database, and run psql commands, with `heroku pg:psql`

You should be updating both github and Heroku on a regular basis.

Push new updates from your local machine to github to save your work remotely.
When ready to deploy updates, push updates from your local machine to heroku.
